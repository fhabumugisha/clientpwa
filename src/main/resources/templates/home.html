<html lang="en" xmlns:th="http://www.thymeleaf.org" xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="">
    <meta name="author" content="Mark Otto, Jacob Thornton, and Bootstrap contributors">
    <meta name="generator" content="Jekyll v3.8.5">
    <title>Client PWA</title>
	
    <!-- Bootstrap core CSS -->
<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.0/css/bootstrap.min.css" integrity="sha384-PDle/QlgIONtM1aqA2Qemk5gPOE7wFq8+Em+G/hmo5Iq0CCmYZLv3fVRDJ4MMwEA" crossorigin="anonymous">
<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" >

<link href="../static/css/app.css" rel="stylesheet" th:href="@{/css/app.css}" type="text/css" ></link>
<link rel="manifest" href="../static/manifest.json" th:href="@{manifest.json}"> 
<!-- SAFARI -->
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black">
<meta name="apple-mobile-web-app-title" content="CApPwa">

<!-- Chrome -->
<link rel="icon" type="image/png" sizes="192x192"  href="/images/icons/android-icon-192x192.png">
<link rel="icon" type="image/png" sizes="32x32" href="/images/icons/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="96x96" href="/images/icons/favicon-96x96.png">
<link rel="icon" type="image/png" sizes="16x16" href="/images/icons/favicon-16x16.png">
<link rel="apple-touch-icon" sizes="57x57" href="/images/icons/apple-icon-57x57.png">
<link rel="apple-touch-icon" sizes="60x60" href="/images/icons/apple-icon-60x60.png">
<link rel="apple-touch-icon" sizes="72x72" href="/images/icons/apple-icon-72x72.png">
<link rel="apple-touch-icon" sizes="76x76" href="/images/icons/apple-icon-76x76.png">
<link rel="apple-touch-icon" sizes="114x114" href="/images/icons/apple-icon-114x114.png">
<link rel="apple-touch-icon" sizes="120x120" href="/images/icons/apple-icon-120x120.png">
<link rel="apple-touch-icon" sizes="144x144" href="/images/icons/apple-icon-144x144.png">
<link rel="apple-touch-icon" sizes="152x152" href="/images/icons/apple-icon-152x152.png">
<link rel="apple-touch-icon" sizes="180x180" href="/images/icons/apple-icon-180x180.png">
<meta name="theme-color" content="#3f51b5">

<!-- IE -->
<meta name="msapplication-TileImage" content="/images/icons/app-icon-144x144.png">
<meta name="msapplication-TileColor" content="#fff">



</head>
  <body>
  <header>
    <nav class="navbar navbar-expand-lg bg-dark  navbar-dark">
    
  
  <a class="navbar-brand" href="#" th:href="@{/}">Client PWA</a>
  	    
      <span class="badge badge-light notifBadge"></span> &nbsp; &nbsp;
 
  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>

  <div class="collapse navbar-collapse" id="navbarSupportedContent">
    <ul class="navbar-nav mr-auto">
     
<!--       <li class="nav-item"> -->
<!--       <a class="nav-link" href="#" th:href="@{/logout}">Sign out</a> -->
<!--       </li> -->
     <li class="nav-item">
        <button class="btn btn-primary d-none" id="notifyBtn" disabled="true">
            <i class="fa fa-bell-o notifyIcon"></i>&nbsp;Push notifications
        </button>
   
      </li>
     
    </ul>
    
  </div>
</nav>
</header>
<main role="main" class="container-fluid">

 
   
<br> <br>

      <h2 style="color:  #4608ad">Messages</h2>

<div class="row">
	<div class="col-md-6">
	    <a href="#" id="my-notification-button" style="display: none;">Subscribe to Notifications</a>
	
	</div>
</div>
	<div class="row">

		<div class="col-md-4 " th:each="message : ${messages}"  >
			<div class="card border-primary mb-4 messageBox" data-th-data-url="${message.id}">

				<div class="card-body text-primary">
					<h5 class="card-title">
						<span th:text="${message.title}"></span>
					</h5>
					<p class="card-text">
						<span th:text="${message.description}"></span>
					</p>
				</div>
				<div class="card-footer bg-transparent border-primary">
					<span
						th:text="${#dates.format(message.dateCreation, 'dd-MM-yyyy')}"></span>
				</div>
			</div>
		</div>
		
	</div>
<div th:if="${#lists.isEmpty(messages)}" class="alert alert-warning col-md-4" role="alert">
			No message yet
		</div>

	<div class="fab" data-url="/ask-question"> ?</div>

      
</main>
<footer class="footer">
  <div class="container">
    <span class="text-muted">Progressive web app demo.</span>
  </div>
</footer>

<script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js" integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.0/js/bootstrap.min.js" integrity="sha384-7aThvCh9TypR7fIc2HV4O/nFMVCBwyIUKL8XCtKE+8xgCgl/PQGuFsvShjr74PBp" crossorigin="anonymous"></script>

<script src="../static/js/promise.js" th:src="@{/js/promise.js}" type="text/javascript"> </script>
<script src="../static/js/fetch.js" th:src="@{/js/fetch.js}" type="text/javascript"></script>
<script src="../static/js/idb.js" th:src="@{/js/idb.js}" type="text/javascript"> </script>
<script src="../static/js/utility.js" th:src="@{/js/utility.js}" type="text/javascript">  </script>
 <script src="../static/js/app.js" th:src="@{/js/app.js}" type="text/javascript">  </script>
      
  <script>
 
    var OneSignal = window.OneSignal || [];
    OneSignal.push(function() {
      OneSignal.init({
        appId: "72dcc69a-ea6e-43d8-a00c-5c27f9cb80ad",
        allowLocalhostAsSecureOrigin: true,
       // requiresUserPrivacyConsent: true,
        autoResubscribe: true,
        notifyButton: {
          enable: true,
        },
        welcomeNotification: {
            "title": "My Custom Title",
            "message": "Thanks for subscribing!",
            // "url": "" /* Leave commented for the notification to not open a window on Chrome and Firefox (on Safari, it opens to your webpage) */
          }
      });
     
      OneSignal.showNativePrompt();
    });
    
    
    
    
//     function onManageWebPushSubscriptionButtonClicked(event) {
//         getSubscriptionState().then(function(state) {
//             if (state.isPushEnabled) {
//                 /* Subscribed, opt them out */
//                 OneSignal.setSubscription(false);
//             } else {
//                 if (state.isOptedOut) {
//                     /* Opted out, opt them back in */
//                     OneSignal.setSubscription(true);
//                 } else {
//                     /* Unsubscribed, subscribe them */
//                     OneSignal.registerForPushNotifications();
//                 }
//             }
//         });
//         event.preventDefault();
//     }

//     function updateMangeWebPushSubscriptionButton(buttonSelector) {
//         var hideWhenSubscribed = false;
//         var subscribeText = "Subscribe to Notifications";
//         var unsubscribeText = "Unsubscribe from Notifications";

//         getSubscriptionState().then(function(state) {
//             var buttonText = !state.isPushEnabled || state.isOptedOut ? subscribeText : unsubscribeText;

//             var element = document.querySelector(buttonSelector);
//             if (element === null) {
//                 return;
//             }

//             element.removeEventListener('click', onManageWebPushSubscriptionButtonClicked);
//             element.addEventListener('click', onManageWebPushSubscriptionButtonClicked);
//             element.textContent = buttonText;

//             if (state.hideWhenSubscribed && state.isPushEnabled) {
//                 element.style.display = "none";
//             } else {
//                 element.style.display = "";
//             }
//         });
//     }

//     function getSubscriptionState() {
//         return Promise.all([
//           OneSignal.isPushNotificationsEnabled(),
//           OneSignal.isOptedOut()
//         ]).then(function(result) {
//             var isPushEnabled = result[0];
//             var isOptedOut = result[1];

//             return {
//                 isPushEnabled: isPushEnabled,
//                 isOptedOut: isOptedOut
//             };
//         });
//     }

//     var OneSignal = OneSignal || [];
//     var buttonSelector = "#my-notification-button";

//     /* This example assumes you've already initialized OneSignal */
//     OneSignal.push(function() {
//         // If we're on an unsupported browser, do nothing
//         if (!OneSignal.isPushNotificationsSupported()) {
//             return;
//         }
//         updateMangeWebPushSubscriptionButton(buttonSelector);
//         OneSignal.on("subscriptionChange", function(isSubscribed) {
//             /* If the user's subscription state changes during the page's session, update the button text */
//             updateMangeWebPushSubscriptionButton(buttonSelector);
//         });
//     });
  </script>

</body></html>